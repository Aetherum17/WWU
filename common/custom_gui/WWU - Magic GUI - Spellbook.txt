#--------------
# Magic Usage
#--------------
custom_text_box = {
   name = magic_gui_usage_title
   potential = { 
        has_spellbook_window_open = yes
   }
}

# Attributes
custom_text_box = {
   name = magic_gui_attribute_aptitude
   tooltip = RULER_ATTRIBUTE_APTITUDE_HOVER_TT
   
   potential = { 
        has_spellbook_window_open = yes
   }
}
custom_text_box = {
   name = magic_gui_attribute_finesse
   tooltip = RULER_ATTRIBUTE_FINESSE_HOVER_TT
   
   potential = { 
        has_spellbook_window_open = yes
   }
}
custom_text_box = {
   name = magic_gui_attribute_concentration
   tooltip = RULER_ATTRIBUTE_CONCENTRATION_HOVER_TT
   
   potential = { 
        has_spellbook_window_open = yes
   }
}

# Aptitude: Max
custom_icon = {
   name = magic_gui_aptitude_icon
    tooltip = RULER_ATTRIBUTE_APTITUDE_MAX_HOVER_TT
    
   potential = { 
        has_spellbook_window_open = yes
        has_legendary_aptitude = yes
   }
}

# Aptitude: Can Increase
custom_button = {
    name = magic_gui_boost_aptitude
    tooltip = RULER_ATTRIBUTE_BOOST_APTITUDE_HOVER_TT
    
    potential = {
        has_spellbook_window_open = yes
        NOT = { has_legendary_aptitude = yes }
    }
    
    trigger = { 
        has_aptitude_boost_cost = yes
    }
    
    effect = { 
        take_aptitude_boost_cost = yes
        add_aptitude_point = yes
    }
}

# Finesse: Max
custom_icon = {
   name = magic_gui_finesse_icon
    tooltip = RULER_ATTRIBUTE_FINESSE_MAX_HOVER_TT
    
   potential = { 
        has_spellbook_window_open = yes
        has_legendary_finesse = yes
   }
}

# Finesse: Can Increase
custom_button = {
    name = magic_gui_boost_finesse
    tooltip = RULER_ATTRIBUTE_BOOST_FINESSE_HOVER_TT
    
    potential = {
        has_spellbook_window_open = yes
        NOT = { has_legendary_finesse = yes }
    }
    
    trigger = { 
        has_finesse_boost_cost = yes
    }
    
    effect = { 
        take_finesse_boost_cost = yes
        add_finesse_point = yes
    }
}

# Conentration: Max
custom_icon = {
   name = magic_gui_concentration_icon
    tooltip = RULER_ATTRIBUTE_CONCENTRATION_MAX_HOVER_TT
    
   potential = { 
        has_spellbook_window_open = yes
        has_legendary_concentration = yes
   }
}

# Concentration: Can Increase
custom_button = {
    name = magic_gui_boost_concentration
    tooltip = RULER_ATTRIBUTE_BOOST_CONCENTRATION_HOVER_TT
    
    potential = {
        has_spellbook_window_open = yes
        NOT = { has_legendary_concentration = yes }
    }
    
    trigger = { 
        has_concentration_boost_cost = yes
    }
    
    effect = { 
        take_concentration_boost_cost = yes
        add_concentration_point = yes
    }
}

# Change Magic School
custom_button = {
    name = magic_gui_magic_school_button
    tooltip = RULER_MAGIC_SCHOOL_HOVER_TT
    
    potential = {
        has_spellbook_window_open = yes
    }
    
    trigger = { 
        NOT = { has_country_modifier = recently_changed_magic_specalization }
    }
    
    effect = { 
        hidden_effect = {
            if = {
                limit = {
                    NOT = { has_school_selection_window_open = yes }
                }
                
                set_country_flag = gui_flag__magic_school_selection_open
            }
            else = {
                clr_country_flag = gui_flag__magic_school_selection_open
            }
        }
    }
}

#--------------
# Magic School
#--------------
# Title
custom_text_box = {
   name = magic_gui_magic_school_title
   tooltip = RULER_MAGIC_GENERIC_SPELLS_TT
   
   potential = { 
        has_spellbook_window_open = yes
   }
}
custom_text_box = {
   name = magic_gui_school_spells_title
   tooltip = RULER_MAGIC_CURRENT_SPECIALIZATION_TT
   
   potential = { 
        has_spellbook_window_open = yes
   }
}
custom_text_box = {
   name = magic_gui_unique_spells_title
   tooltip = RULER_MAGIC_UNIQUE_SPELLS_TT
   
   potential = { 
        has_spellbook_window_open = yes
   }
}

# Magic School Section Title
custom_text_box = {
   name = magic_gui_magic_school_section_title
   
   potential = { 
        has_school_selection_window_open = yes
   }
}

# Magic School: Arcane
custom_button = {
    name = magic_gui_school_button_1
    tooltip = RULER_MAGIC_SPECIALIZATION_HOVER_ARCANE_TT
    
    potential = {
        has_school_selection_window_open = yes
    }
    
    trigger = { 
        magic_school_change_cost = yes
        can_select_school__arcane = yes
    }
    
    effect = { 
        take_magic_school_change_cost = yes
        
        set_magic_school = {
            arcane = yes
        }
    }
}
# Magic School: Holy
custom_button = {
    name = magic_gui_school_button_2
    tooltip = RULER_MAGIC_SPECIALIZATION_HOVER_HOLY_TT
    
    potential = {
        has_school_selection_window_open = yes
    }
    
    trigger = { 
        magic_school_change_cost = yes
        can_select_school__holy = yes
    }
    
    effect = { 
        take_magic_school_change_cost = yes
        
        set_magic_school = {
            holy = yes
        }
    }
}
# Magic School: Chi
custom_button = {
    name = magic_gui_school_button_3
    tooltip = RULER_MAGIC_SPECIALIZATION_HOVER_CHI_TT
    
    potential = {
        has_school_selection_window_open = yes
    }
    
    trigger = { 
        magic_school_change_cost = yes
        can_select_school__chi = yes
    }
    
    effect = { 
        take_magic_school_change_cost = yes
        
        set_magic_school = {
            chi = yes
        }
    }
}
# Magic School: Voodoo
custom_button = {
    name = magic_gui_school_button_4
    tooltip = RULER_MAGIC_SPECIALIZATION_HOVER_VOODOO_TT
    
    potential = {
        has_school_selection_window_open = yes
    }
    
    trigger = { 
        magic_school_change_cost = yes
        can_select_school__voodoo = yes
    }
    
    effect = { 
        take_magic_school_change_cost = yes
        
        set_magic_school = {
            voodoo = yes
        }
    }
}
# Magic School: Nature
custom_button = {
    name = magic_gui_school_button_5
    tooltip = RULER_MAGIC_SPECIALIZATION_HOVER_NATURE_TT
    
    potential = {
        has_school_selection_window_open = yes
    }
    
    trigger = { 
        magic_school_change_cost = yes
        can_select_school__nature = yes
    }
    
    effect = { 
        take_magic_school_change_cost = yes
        
        set_magic_school = {
            nature = yes
        }
    }
}
# Magic School: Necromancy
custom_button = {
    name = magic_gui_school_button_6
    tooltip = RULER_MAGIC_SPECIALIZATION_HOVER_NECROMANCY_TT
    
    potential = {
        has_school_selection_window_open = yes
    }
    
    trigger = { 
        magic_school_change_cost = yes
        can_select_school__necromancy = yes
    }
    
    effect = { 
        take_magic_school_change_cost = yes
        
        set_magic_school = {
            necromancy = yes
        }
    }
}
# Magic School: Shamanism
custom_button = {
    name = magic_gui_school_button_7
    tooltip = RULER_MAGIC_SPECIALIZATION_HOVER_SHAMANISM_TT
    
    potential = {
        has_school_selection_window_open = yes
    }
    
    trigger = { 
        magic_school_change_cost = yes
        can_select_school__shamanism = yes
    }
    
    effect = { 
        take_magic_school_change_cost = yes
        
        set_magic_school = {
            shaman = yes
        }
    }
}
# Magic School: Fel
custom_button = {
    name = magic_gui_school_button_8
    tooltip = RULER_MAGIC_SPECIALIZATION_HOVER_FEL_TT
    
    potential = {
        has_school_selection_window_open = yes
    }
    
    trigger = { 
        magic_school_change_cost = yes
        can_select_school__fel = yes
    }
    
    effect = { 
        take_magic_school_change_cost = yes
        
        set_magic_school = {
            fel = yes
        }
    }
}
# Magic School: Draconic
custom_button = {
    name = magic_gui_school_button_9
    tooltip = RULER_MAGIC_SPECIALIZATION_HOVER_DRACONIC_TT
    
    potential = {
        has_school_selection_window_open = yes
    }
    
    trigger = { 
        magic_school_change_cost = yes
        can_select_school__draconic = yes
    }
    
    effect = { 
        take_magic_school_change_cost = yes
        
        set_magic_school = {
            dragon = yes
        }
    }
}
# Magic School: Corruption
custom_button = {
    name = magic_gui_school_button_10
    tooltip = RULER_MAGIC_SPECIALIZATION_HOVER_CORRUPTION_TT
    
    potential = {
        has_school_selection_window_open = yes
    }
    
    trigger = { 
        magic_school_change_cost = yes
        can_select_school__corruption = yes
    }
    
    effect = { 
        take_magic_school_change_cost = yes
        
        set_magic_school = {
            corruption = yes
        }
    }
}
# Magic School: Shadow
custom_button = {
    name = magic_gui_school_button_11
    tooltip = RULER_MAGIC_SPECIALIZATION_HOVER_SHADOW_TT
    
    potential = {
        has_school_selection_window_open = yes
    }
    
    trigger = { 
        magic_school_change_cost = yes
        can_select_school__shadow = yes
    }
    
    effect = { 
        take_magic_school_change_cost = yes
        
        set_magic_school = {
            shadow = yes
        }
    }
}
# Magic School: Titanic
custom_button = {
    name = magic_gui_school_button_12
    tooltip = RULER_MAGIC_SPECIALIZATION_HOVER_TITANIC_TT
    
    potential = {
        has_school_selection_window_open = yes
    }
    
    trigger = { 
        magic_school_change_cost = yes
        can_select_school__titanic = yes
    }
    
    effect = { 
        take_magic_school_change_cost = yes
        
        set_magic_school = {
            titan = yes
        }
    }
}
# Magic School: Runic
custom_button = {
    name = magic_gui_school_button_13
    tooltip = RULER_MAGIC_SPECIALIZATION_HOVER_RUNIC_TT
    
    potential = {
        has_school_selection_window_open = yes
    }
    
    trigger = { 
        magic_school_change_cost = yes
        can_select_school__runic = yes
    }
    
    effect = { 
        take_magic_school_change_cost = yes
        
        set_magic_school = {
            runic = yes
        }
    }
}
# Magic School: Nightmare
custom_button = {
    name = magic_gui_school_button_14
    tooltip = RULER_MAGIC_SPECIALIZATION_HOVER_NIGHTMARE_TT
    
    potential = {
        has_school_selection_window_open = yes
    }
    
    trigger = { 
        magic_school_change_cost = yes
        can_select_school__nightmare = yes
    }
    
    effect = { 
        take_magic_school_change_cost = yes
        
        set_magic_school = {
            nightmare = yes
        }
    }
}
# Magic School: Earth
custom_button = {
    name = magic_gui_school_button_15
    tooltip = RULER_MAGIC_SPECIALIZATION_HOVER_EARTH_TT
    
    potential = {
        has_school_selection_window_open = yes
    }
    
    trigger = { 
        magic_school_change_cost = yes
        can_select_school__earth = yes
    }
    
    effect = { 
        take_magic_school_change_cost = yes
        
        set_magic_school = {
            elemental_earth = yes
        }
    }
}
# Magic School: Fire
custom_button = {
    name = magic_gui_school_button_16
    tooltip = RULER_MAGIC_SPECIALIZATION_HOVER_FIRE_TT
    
    potential = {
        has_school_selection_window_open = yes
    }
    
    trigger = { 
        magic_school_change_cost = yes
        can_select_school__fire = yes
        
    }
    
    effect = { 
        take_magic_school_change_cost = yes
        
        set_magic_school = {
            elemental_fire = yes
        }
    }
}
# Magic School: Water
custom_button = {
    name = magic_gui_school_button_17
    tooltip = RULER_MAGIC_SPECIALIZATION_HOVER_WATER_TT
    
    potential = {
        has_school_selection_window_open = yes
    }
    
    trigger = { 
        magic_school_change_cost = yes
        can_select_school__water = yes
    }
    
    effect = { 
        take_magic_school_change_cost = yes
        
        set_magic_school = {
            elemental_water = yes
        }
    }
}
# Magic School: Wind
custom_button = {
    name = magic_gui_school_button_18
    tooltip = RULER_MAGIC_SPECIALIZATION_HOVER_WIND_TT
    
    potential = {
        has_school_selection_window_open = yes
    }
    
    trigger = { 
        magic_school_change_cost = yes
        can_select_school__wind = yes
    }
    
    effect = { 
        take_magic_school_change_cost = yes
        
        set_magic_school = {
            elemental_air = yes
        }
    }
}
# Magic School: Domination
custom_button = {
    name = magic_gui_school_button_19
    tooltip = RULER_MAGIC_SPECIALIZATION_HOVER_DOMINATION_TT
    
    potential = {
        has_school_selection_window_open = yes
    }
    
    trigger = { 
        magic_school_change_cost = yes
        can_select_school__domination = yes
    }
    
    effect = { 
        take_magic_school_change_cost = yes
        
        set_magic_school = {
            domination = yes
        }
    }
}
# Magic School: Soul
custom_button = {
    name = magic_gui_school_button_20
    tooltip = RULER_MAGIC_SPECIALIZATION_HOVER_SOUL_TT
    
    potential = {
        has_school_selection_window_open = yes
    }
    
    trigger = { 
        magic_school_change_cost = yes
        can_select_school__soul = yes
    }
    
    effect = { 
        take_magic_school_change_cost = yes
        
        set_magic_school = {
            soul = yes
        }
    }
}

#--------------
# Mana
#--------------
# Mana Full: 1
custom_icon = {
   name = magic_gui_mana_symbol_1
    tooltip = RULER_MANA_FULL_1
    
   potential = { 
        has_spellbook_window_open = yes
        check_variable = {
            which = ruler_magic_mana
            value = 1
        }
   }
}
# Mana Full: 2
custom_icon = {
   name = magic_gui_mana_symbol_2
    tooltip = RULER_MANA_FULL_2
    
   potential = { 
        has_spellbook_window_open = yes
        check_variable = {
            which = ruler_magic_mana
            value = 2
        }
   }
}
# Mana Full: 3
custom_icon = {
   name = magic_gui_mana_symbol_3
    tooltip = RULER_MANA_FULL_3
    
   potential = { 
        has_spellbook_window_open = yes
        check_variable = {
            which = ruler_magic_mana
            value = 3
        }
   }
}
# Mana Full: 4
custom_icon = {
   name = magic_gui_mana_symbol_4
    tooltip = RULER_MANA_FULL_4
    
   potential = { 
        has_spellbook_window_open = yes
        check_variable = {
            which = ruler_magic_mana
            value = 4
        }
   }
}
# Mana Full: 5
custom_icon = {
   name = magic_gui_mana_symbol_5
    tooltip = RULER_MANA_FULL_5
    
   potential = { 
        has_spellbook_window_open = yes
        check_variable = {
            which = ruler_magic_mana
            value = 5
        }
   }
}
# Mana Full: 6
custom_icon = {
   name = magic_gui_mana_symbol_6
    tooltip = RULER_MANA_FULL_6
    
   potential = { 
        has_spellbook_window_open = yes
        check_variable = {
            which = ruler_magic_mana
            value = 6
        }
   }
}
# Mana Full: 7
custom_icon = {
   name = magic_gui_mana_symbol_7
    tooltip = RULER_MANA_FULL_7
    
   potential = { 
        has_spellbook_window_open = yes
        check_variable = {
            which = ruler_magic_mana
            value = 7
        }
   }
}
# Mana Full: 8
custom_icon = {
   name = magic_gui_mana_symbol_8
    tooltip = RULER_MANA_FULL_8
    
   potential = { 
        has_spellbook_window_open = yes
        check_variable = {
            which = ruler_magic_mana
            value = 8
        }
   }
}
# Mana Full: 9
custom_icon = {
   name = magic_gui_mana_symbol_9
    tooltip = RULER_MANA_FULL_9
    
   potential = { 
        has_spellbook_window_open = yes
        check_variable = {
            which = ruler_magic_mana
            value = 9
        }
   }
}
# Mana Full: 10
custom_icon = {
   name = magic_gui_mana_symbol_10
    tooltip = RULER_MANA_FULL_10
    
   potential = { 
        has_spellbook_window_open = yes
        check_variable = {
            which = ruler_magic_mana
            value = 10
        }
   }
}

# Mana Empty: 1
custom_icon = {
   name = magic_gui_mana_symbol_empty_1
    tooltip = RULER_MANA_EMPTY_1
    
   potential = { 
        has_spellbook_window_open = yes
        NOT = {
            check_variable = {
                which = ruler_magic_mana
                value = 1
            }
        }
   }
}
# Mana Empty: 2
custom_icon = {
   name = magic_gui_mana_symbol_empty_2
    tooltip = RULER_MANA_EMPTY_2
    
   potential = { 
        has_spellbook_window_open = yes
        NOT = {
            check_variable = {
                which = ruler_magic_mana
                value = 2
            }
        }
   }
}
# Mana Empty: 3
custom_icon = {
   name = magic_gui_mana_symbol_empty_3
    tooltip = RULER_MANA_EMPTY_3
    
   potential = { 
        has_spellbook_window_open = yes
        NOT = {
            check_variable = {
                which = ruler_magic_mana
                value = 3
            }
        }
   }
}
# Mana Empty: 4
custom_icon = {
   name = magic_gui_mana_symbol_empty_4
    tooltip = RULER_MANA_EMPTY_4
    
   potential = { 
        has_spellbook_window_open = yes
        NOT = {
            check_variable = {
                which = ruler_magic_mana
                value = 4
            }
        }
   }
}
# Mana Empty: 5
custom_icon = {
   name = magic_gui_mana_symbol_empty_5
    tooltip = RULER_MANA_EMPTY_5
    
   potential = { 
        has_spellbook_window_open = yes
        NOT = {
            check_variable = {
                which = ruler_magic_mana
                value = 5
            }
        }
   }
}
# Mana Empty: 6
custom_icon = {
   name = magic_gui_mana_symbol_empty_6
    tooltip = RULER_MANA_EMPTY_6
    
   potential = { 
        has_spellbook_window_open = yes
        NOT = {
            check_variable = {
                which = ruler_magic_mana
                value = 6
            }
        }
   }
}
# Mana Empty: 7
custom_icon = {
   name = magic_gui_mana_symbol_empty_7
    tooltip = RULER_MANA_EMPTY_7
    
   potential = { 
        has_spellbook_window_open = yes
        NOT = {
            check_variable = {
                which = ruler_magic_mana
                value = 7
            }
        }
   }
}
# Mana Empty: 8
custom_icon = {
   name = magic_gui_mana_symbol_empty_8
    tooltip = RULER_MANA_EMPTY_8
    
   potential = { 
        has_spellbook_window_open = yes
        NOT = {
            check_variable = {
                which = ruler_magic_mana
                value = 8
            }
        }
   }
}
# Mana Empty: 9
custom_icon = {
   name = magic_gui_mana_symbol_empty_9
    tooltip = RULER_MANA_EMPTY_9
    
   potential = { 
        has_spellbook_window_open = yes
        NOT = {
            check_variable = {
                which = ruler_magic_mana
                value = 9
            }
        }
   }
}
# Mana Empty: 10
custom_icon = {
   name = magic_gui_mana_symbol_empty_10
    tooltip = RULER_MANA_EMPTY_10
    
   potential = { 
        has_spellbook_window_open = yes
        NOT = {
            check_variable = {
                which = ruler_magic_mana
                value = 10
            }
        }
   }
}

#--------------
# Spell - Generic
#--------------
# Conjure Gold
custom_button = {
    name = magic_spell_generic_1
    tooltip = GENERIC_SPELL_1_TT
    
    potential = {
        has_spellbook_window_open = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_3 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else = {
            has_mana_5 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_3 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else = {
            lose_mana_5 = yes
        }
        
        treasury_spell_effect = yes
    }
}
# Inspire Glory
custom_button = {
    name = magic_spell_generic_2
    tooltip = GENERIC_SPELL_2_TT
    
    potential = {
        has_spellbook_window_open = yes
    }
    
    trigger = { 
        NOT = { prestige = 100 }
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_2 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_3 = yes
        }
        else = {
            has_mana_4 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_2 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_3 = yes
        }
        else = {
            lose_mana_4 = yes
        }
        
        prestige_spell_effect = yes
    }
}
# Purge Opponents
custom_button = {
    name = magic_spell_generic_3
    tooltip = GENERIC_SPELL_3_TT
    
    potential = {
        has_spellbook_window_open = yes
    }
    
    trigger = {     
        NOT = { corruption = 100 }
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        remove_corruption_spell_effect = yes
    }
}
# Emit Splendiferous Show
custom_button = {
    name = magic_spell_generic_4
    tooltip = GENERIC_SPELL_4_TT
    
    potential = {
        has_spellbook_window_open = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_2 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_3 = yes
        }
        else = {
            has_mana_4 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_2 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_3 = yes
        }
        else = {
            lose_mana_4 = yes
        }
        
        splendor_spell_effect = yes
    }
}
# Arouse Support
custom_button = {
    name = magic_spell_generic_5
    tooltip = GENERIC_SPELL_5_TT
    
    potential = {
        has_spellbook_window_open = yes
    }
    
    trigger = { 
        if = {
            limit = {
                government = monarchy
            }
            
            NOT = { legitimacy = 100 }
        }
        if = {
            limit = {
                government = republic
            }
            
            NOT = { republican_tradition = 100 }
        }
        if = {
            limit = {
                uses_devotion = yes
            }
            
            NOT = { devotion = 100 }
        }
        if = {
            limit = {
                uses_horde_unity = yes
            }
            
            NOT = { horde_unity = 100 }
        }
        
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_2 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_3 = yes
        }
        else = {
            has_mana_4 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_2 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_3 = yes
        }
        else = {
            lose_mana_4 = yes
        }
        
        legitimacy_spell_effect = yes
    }
}
# Soothe Population
custom_button = {
    name = magic_spell_generic_6
    tooltip = GENERIC_SPELL_6_TT
    
    potential = {
        has_spellbook_window_open = yes
    }
    
    trigger = { 
        NOT = { stability = 3 }
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        stability_spell_effect = yes
    }
}
# Quell Fear
custom_button = {
    name = magic_spell_generic_7
    tooltip = GENERIC_SPELL_7_TT
    
    potential = {
        has_spellbook_window_open = yes
    }
    
    trigger = { 
        war_exhaustion = 0.01
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_3 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else = {
            has_mana_5 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_3 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else = {
            lose_mana_5 = yes
        }
        
        remove_war_exhaustion_spell_effect = yes
    }
}
# Rally Soldiers
custom_button = {
    name = magic_spell_generic_8
    tooltip = GENERIC_SPELL_8_TT
    
    potential = {
        has_spellbook_window_open = yes
    }
    
    trigger = { 
        NOT = { manpower_percentage = 1.0 }
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_2 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_3 = yes
        }
        else = {
            has_mana_4 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_2 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_3 = yes
        }
        else = {
            lose_mana_4 = yes
        }
        
        yearly_manpower_spell_effect = yes
    }
}
# Rally Sailors
custom_button = {
    name = magic_spell_generic_9
    tooltip = GENERIC_SPELL_9_TT
    
    potential = {
        has_spellbook_window_open = yes
    }
    
    trigger = { 
        NOT = { sailors_percentage = 1.0 }
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_2 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_3 = yes
        }
        else = {
            has_mana_4 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_2 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_3 = yes
        }
        else = {
            lose_mana_4 = yes
        }
        
        yearly_sailors_spell_effect = yes
    }
}
# Galvinize Creativity
custom_button = {
    name = magic_spell_generic_10
    tooltip = GENERIC_SPELL_10_TT
    
    potential = {
        has_spellbook_window_open = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        reform_progress_spell_effect = yes
    }
}

#--------------
# Spell - School
#--------------
#-------
# Arcane
#-------
# Arcane - Polymorph
custom_button = {
    name = magic_spell_arcane_1
    tooltip = ARCANE_SPELL_1_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__arcane = yes
    }
    
    trigger = { 
        any_owned_province = {
            OR = {
                NOT = { culture = ROOT }
                NOT = { religion = ROOT }
            }
        }
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        polymorph_effect = yes
    }
}
# Arcane - Presence of Mind
custom_button = {
    name = magic_spell_arcane_2
    tooltip = ARCANE_SPELL_2_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__arcane = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        monarch_power_spell_effect = yes
    }
}
# Arcane - Touch of the Magi
custom_button = {
    name = magic_spell_arcane_3
    tooltip = ARCANE_SPELL_3_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__arcane = yes
    }
    
    trigger = { 
        NOT = {
            has_modifier_spell_effect = {
                MODIFIER = touch_of_the_magi
            }
        }
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        apply_modifier_spell_effect = {
            MODIFIER = touch_of_the_magi
        }
    }
}
# Arcane - Alter Time
custom_button = {
    name = magic_spell_arcane_4
    tooltip = ARCANE_SPELL_4_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__arcane = yes
    }
    
    trigger = { 
        NOT = {
            has_modifier_spell_effect = {
                MODIFIER = alter_time
            }
        }
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        apply_modifier_spell_effect = {
            MODIFIER = alter_time
        }
    }
}

#-------
# Holy
#-------
# Holy - Judgment
custom_button = {
    name = magic_spell_holy_1
    tooltip = HOLY_SPELL_1_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__holy = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_6 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_7 = yes
        }
        else = {
            has_mana_8 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_6 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_7 = yes
        }
        else = {
            lose_mana_8 = yes
        }
        
        judgment_effect = yes
    }
}
# Holy - Divine Tempest
custom_button = {
    name = magic_spell_holy_2
    tooltip = HOLY_SPELL_2_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__holy = yes
    }
    
    trigger = { 
        NOT = {
            has_modifier_spell_effect = {
                MODIFIER = divine_tempest
            }
        }
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_3 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else = {
            has_mana_5 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_3 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else = {
            lose_mana_5 = yes
        }
        
        apply_modifier_spell_effect = {
            MODIFIER = divine_tempest
        }
    }
}

# Holy - Fortifying Aura
custom_button = {
    name = magic_spell_holy_3
    tooltip = HOLY_SPELL_3_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__holy = yes
    }
    
    trigger = { 
        NOT = {
            has_modifier_spell_effect = {
                MODIFIER = fortifying_aura
            }
        }
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_3 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else = {
            has_mana_5 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_3 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else = {
            lose_mana_5 = yes
        }
        
        apply_modifier_spell_effect = {
            MODIFIER = fortifying_aura
        }
    }
}

# Holy - Avatar of the Light
custom_button = {
    name = magic_spell_holy_4
    tooltip = HOLY_SPELL_4_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__holy = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_6 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_7 = yes
        }
        else = {
            has_mana_8 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_6 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_7 = yes
        }
        else = {
            lose_mana_8 = yes
        }
        
        avatar_of_the_light_effect = yes
    }
}

#-------
# Chi
#-------
# Chi - Ring of Peace
custom_button = {
    name = magic_spell_chi_1
    tooltip = CHI_SPELL_1_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__chi = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_6 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_7 = yes
        }
        else = {
            has_mana_8 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_6 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_7 = yes
        }
        else = {
            lose_mana_8 = yes
        }
        
        ring_of_peace_effect = yes
    }
}
# Chi - Renewing Mists
custom_button = {
    name = magic_spell_chi_2
    tooltip = CHI_SPELL_2_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__chi = yes
    }
    
    trigger = { 
        NOT = {
            has_modifier_spell_effect = {
                MODIFIER = renewing_mist
            }
        }
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        apply_modifier_spell_effect = {
            MODIFIER = renewing_mist
        }
    }
}
# Chi - Secret Infusion
custom_button = {
    name = magic_spell_chi_3
    tooltip = CHI_SPELL_3_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__chi = yes
    }
    
    trigger = { 
        NOT = {
            has_modifier_spell_effect = {
                MODIFIER = secret_infusion
            }
        }
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_6 = yes
        }
        else = {
            has_mana_7 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_6 = yes
        }
        else = {
            lose_mana_7 = yes
        }
        
        apply_modifier_spell_effect = {
            MODIFIER = secret_infusion
        }
    }
}
# Chi - Mists of Wisdom
custom_button = {
    name = magic_spell_chi_4
    tooltip = CHI_SPELL_4_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__chi = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_8 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_9 = yes
        }
        else = {
            has_mana_10 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_8 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_9 = yes
        }
        else = {
            lose_mana_10 = yes
        }
        
        random_tech_spell_effect = yes
    }
}

#-------
# Voodoo
#-------
# Voodoo - Mass Hex
custom_button = {
    name = magic_spell_voodoo_1
    tooltip = VOODOO_SPELL_1_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__voodoo = yes
    }
    
    trigger = { 
        any_owned_province = {
            NOT = { religion = ROOT }
        }
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_6 = yes
        }
        else = {
            has_mana_7 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_6 = yes
        }
        else = {
            lose_mana_7 = yes
        }
        
        mass_hex_effect = yes
    }
}
# Voodoo - Zombify
custom_button = {
    name = magic_spell_voodoo_2
    tooltip = VOODOO_SPELL_2_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__voodoo = yes
    }
    
    trigger = { 
        NOT = {
            has_modifier_spell_effect = {
                MODIFIER = zombify
            }
        }
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        apply_modifier_spell_effect = {
            MODIFIER = zombify
        }
    }
}
# Voodoo - Healing Wave
custom_button = {
    name = magic_spell_voodoo_3
    tooltip = VOODOO_SPELL_3_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__voodoo = yes
    }
    
    trigger = { 
        NOT = {
            has_modifier_spell_effect = {
                MODIFIER = healing_wave
            }
        }
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_6 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_7 = yes
        }
        else = {
            has_mana_8 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_6 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_7 = yes
        }
        else = {
            lose_mana_8 = yes
        }
        
        apply_modifier_spell_effect = {
            MODIFIER = healing_wave
        }
    }
}
# Voodoo - Big Bad Voodoo
custom_button = {
    name = magic_spell_voodoo_4
    tooltip = VOODOO_SPELL_4_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__voodoo = yes
    }
    
    trigger = { 
        any_owned_province = {
            NOT = { is_core = ROOT }
        }
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_8 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_9 = yes
        }
        else = {
            has_mana_10 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_8 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_9 = yes
        }
        else = {
            lose_mana_10 = yes
        }
        
        big_bad_voodoo_effect = yes
    }
}

#-------
# Nature
#-------
# Nature - 1
custom_button = {
    name = magic_spell_nature_1
    tooltip = NATURE_SPELL_1_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__nature = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}
# Nature - 2
custom_button = {
    name = magic_spell_nature_2
    tooltip = NATURE_SPELL_2_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__nature = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}
# Nature - 3
custom_button = {
    name = magic_spell_nature_3
    tooltip = NATURE_SPELL_3_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__nature = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}
# Nature - 4
custom_button = {
    name = magic_spell_nature_4
    tooltip = NATURE_SPELL_4_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__nature = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}

#-------
# Necromancy
#-------
# Necromancy - 1
custom_button = {
    name = magic_spell_necromancy_1
    tooltip = NECROMANCY_SPELL_1_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__necromancy = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}
# Necromancy - 2
custom_button = {
    name = magic_spell_necromancy_2
    tooltip = NECROMANCY_SPELL_2_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__necromancy = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}
# Necromancy - 3
custom_button = {
    name = magic_spell_necromancy_3
    tooltip = NECROMANCY_SPELL_3_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__necromancy = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}
# Necromancy - 4
custom_button = {
    name = magic_spell_necromancy_4
    tooltip = NECROMANCY_SPELL_4_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__necromancy = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}

#-------
# Shamanism
#-------
# Shamanism - 1
custom_button = {
    name = magic_spell_shamanism_1
    tooltip = SHAMANISM_SPELL_1_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__shamanism = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}
# Shamanism - 2
custom_button = {
    name = magic_spell_shamanism_2
    tooltip = SHAMANISM_SPELL_2_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__shamanism = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}
# Shamanism - 3
custom_button = {
    name = magic_spell_shamanism_3
    tooltip = SHAMANISM_SPELL_3_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__shamanism = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}
# Shamanism - 4
custom_button = {
    name = magic_spell_shamanism_4
    tooltip = SHAMANISM_SPELL_4_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__shamanism = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}

#-------
# Fel
#-------
# Fel - 1
custom_button = {
    name = magic_spell_fel_1
    tooltip = FEL_SPELL_1_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__fel = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}
# Fel - 2
custom_button = {
    name = magic_spell_fel_2
    tooltip = FEL_SPELL_2_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__fel = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}
# Fel - 3
custom_button = {
    name = magic_spell_fel_3
    tooltip = FEL_SPELL_3_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__fel = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}
# Fel - 4
custom_button = {
    name = magic_spell_fel_4
    tooltip = FEL_SPELL_4_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__fel = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}

#-------
# Draconic
#-------
# Draconic - 1
custom_button = {
    name = magic_spell_draconic_1
    tooltip = DRACONIC_SPELL_1_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__draconic = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}
# Draconic - 2
custom_button = {
    name = magic_spell_draconic_2
    tooltip = DRACONIC_SPELL_2_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__draconic = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}
# Draconic - 3
custom_button = {
    name = magic_spell_draconic_3
    tooltip = DRACONIC_SPELL_3_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__draconic = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}
# Draconic - 4
custom_button = {
    name = magic_spell_draconic_4
    tooltip = DRACONIC_SPELL_4_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__draconic = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}

#-------
# Corruption
#-------
# Corruption - 1
custom_button = {
    name = magic_spell_corruption_1
    tooltip = CORRUPTION_SPELL_1_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__corruption = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}
# Corruption - 2
custom_button = {
    name = magic_spell_corruption_2
    tooltip = CORRUPTION_SPELL_2_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__corruption = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}
# Corruption - 3
custom_button = {
    name = magic_spell_corruption_3
    tooltip = CORRUPTION_SPELL_3_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__corruption = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}
# Corruption - 4
custom_button = {
    name = magic_spell_corruption_4
    tooltip = CORRUPTION_SPELL_4_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__corruption = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}

#-------
# Shadow
#-------
# Shadow - 1
custom_button = {
    name = magic_spell_shadow_1
    tooltip = SHADOW_SPELL_1_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__shadow = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}
# Shadow - 2
custom_button = {
    name = magic_spell_shadow_2
    tooltip = SHADOW_SPELL_2_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__shadow = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}
# Shadow - 3
custom_button = {
    name = magic_spell_shadow_3
    tooltip = SHADOW_SPELL_3_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__shadow = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}
# Shadow - 4
custom_button = {
    name = magic_spell_shadow_4
    tooltip = SHADOW_SPELL_4_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__shadow = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}

#-------
# Titanic
#-------
# Titanic - 1
custom_button = {
    name = magic_spell_titanic_1
    tooltip = TITANIC_SPELL_1_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__titanic = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}
# Titanic - 2
custom_button = {
    name = magic_spell_titanic_2
    tooltip = TITANIC_SPELL_2_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__titanic = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}
# Titanic - 3
custom_button = {
    name = magic_spell_titanic_3
    tooltip = TITANIC_SPELL_3_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__titanic = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}
# Titanic - 4
custom_button = {
    name = magic_spell_titanic_4
    tooltip = TITANIC_SPELL_4_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__titanic = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}

#-------
# Runic
#-------
# Runic - 1
custom_button = {
    name = magic_spell_runic_1
    tooltip = RUNIC_SPELL_1_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__runic = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}
# Runic - 2
custom_button = {
    name = magic_spell_runic_2
    tooltip = RUNIC_SPELL_2_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__runic = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}
# Runic - 3
custom_button = {
    name = magic_spell_runic_3
    tooltip = RUNIC_SPELL_3_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__runic = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}
# Runic - 4
custom_button = {
    name = magic_spell_runic_4
    tooltip = RUNIC_SPELL_4_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__runic = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}

#-------
# Nightmare
#-------
# Nightmare - 1
custom_button = {
    name = magic_spell_nightmare_1
    tooltip = NIGHTMARE_SPELL_1_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__nightmare = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}
# Nightmare - 2
custom_button = {
    name = magic_spell_nightmare_2
    tooltip = NIGHTMARE_SPELL_2_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__nightmare = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}
# Nightmare - 3
custom_button = {
    name = magic_spell_nightmare_3
    tooltip = NIGHTMARE_SPELL_3_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__nightmare = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}
# Nightmare - 4
custom_button = {
    name = magic_spell_nightmare_4
    tooltip = NIGHTMARE_SPELL_4_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__nightmare = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}

#-------
# Earth
#-------
# Earth - 1
custom_button = {
    name = magic_spell_earth_1
    tooltip = EARTH_SPELL_1_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__earth = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}
# Earth - 2
custom_button = {
    name = magic_spell_earth_2
    tooltip = EARTH_SPELL_2_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__earth = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}
# Earth - 3
custom_button = {
    name = magic_spell_earth_3
    tooltip = EARTH_SPELL_3_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__earth = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}
# Earth - 4
custom_button = {
    name = magic_spell_earth_4
    tooltip = EARTH_SPELL_4_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__earth = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}

#-------
# Fire
#-------
# Fire - 1
custom_button = {
    name = magic_spell_fire_1
    tooltip = FIRE_SPELL_1_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__fire = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}
# Fire - 2
custom_button = {
    name = magic_spell_fire_2
    tooltip = FIRE_SPELL_2_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__fire = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}
# Fire - 3
custom_button = {
    name = magic_spell_fire_3
    tooltip = FIRE_SPELL_3_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__fire = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}
# Fire - 4
custom_button = {
    name = magic_spell_fire_4
    tooltip = FIRE_SPELL_4_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__fire = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}

#-------
# Water
#-------
# Water - 1
custom_button = {
    name = magic_spell_water_1
    tooltip = WATER_SPELL_1_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__water = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}
# Water - 2
custom_button = {
    name = magic_spell_water_2
    tooltip = WATER_SPELL_2_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__water = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}
# Water - 3
custom_button = {
    name = magic_spell_water_3
    tooltip = WATER_SPELL_3_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__water = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}
# Water - 4
custom_button = {
    name = magic_spell_water_4
    tooltip = WATER_SPELL_4_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__water = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}

#-------
# Wind
#-------
# Wind - 1
custom_button = {
    name = magic_spell_wind_1
    tooltip = WIND_SPELL_1_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__wind = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}
# Wind - 2
custom_button = {
    name = magic_spell_wind_2
    tooltip = WIND_SPELL_2_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__wind = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}
# Wind - 3
custom_button = {
    name = magic_spell_wind_3
    tooltip = WIND_SPELL_3_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__wind = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}
# Wind - 4
custom_button = {
    name = magic_spell_wind_4
    tooltip = WIND_SPELL_4_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__wind = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}

#-------
# Domination
#-------
# Domination - 1
custom_button = {
    name = magic_spell_domination_1
    tooltip = DOMINATION_SPELL_1_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__domination = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}
# Domination - 2
custom_button = {
    name = magic_spell_domination_2
    tooltip = DOMINATION_SPELL_2_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__domination = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}
# Domination - 3
custom_button = {
    name = magic_spell_domination_3
    tooltip = DOMINATION_SPELL_3_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__domination = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}
# Domination - 4
custom_button = {
    name = magic_spell_domination_4
    tooltip = DOMINATION_SPELL_4_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__domination = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}

#-------
# Soul
#-------
# Soul - 1
custom_button = {
    name = magic_spell_soul_1
    tooltip = SOUL_SPELL_1_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__soul = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}
# Soul - 2
custom_button = {
    name = magic_spell_soul_2
    tooltip = SOUL_SPELL_2_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__soul = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}
# Soul - 3
custom_button = {
    name = magic_spell_soul_3
    tooltip = SOUL_SPELL_3_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__soul = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}
# Soul - 4
custom_button = {
    name = magic_spell_soul_4
    tooltip = SOUL_SPELL_4_TT
    
    potential = {
        has_spellbook_window_open = yes
        is_school__soul = yes
    }
    
    trigger = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            has_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            has_mana_5 = yes
        }
        else = {
            has_mana_6 = yes
        }
    }
    
    effect = { 
        if = {
            limit = {
                OR = {
                    has_legendary_aptitude = yes
                    has_epic_aptitude = yes
                }
            }
            lose_mana_4 = yes
        }
        else_if = {
            limit = {
                OR = {
                    has_rare_aptitude = yes
                    has_common_aptitude = yes
                }
            }
            lose_mana_5 = yes
        }
        else = {
            lose_mana_6 = yes
        }
        
        # EFFECT HERE
    }
}

#--------------
# Spell - Unique
#--------------