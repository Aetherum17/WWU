namespace = first_war

# The First War
country_event = {
	id = first_war.1
	title = first_war.1.title
	desc = first_war.1.desc
	picture = ORCISH_INVASION_eventPicture
    
	trigger = {
		current_age = age_orcish_horde
        
        # ROOT's capital is in Outland
        capital_scope = { continent = continent_outland }
        
		# Any Horde own land is Swamp of Sorrows/Blasted Lands
        any_country = {
            has_country_modifier = member_of_old_horde
            any_owned_province = {
                OR = {
                    region = region_swamp_of_sorrows
                    region = region_blasted_lands
                }
            }
        }
        # Any land is empty in Swamp of Sorrows/Blasted Lands
		any_province = {
			OR = {
				region = region_blasted_lands
				region = region_swamp_of_sorrows
			}
			is_empty = yes
		}
        # ROOT doesn't own land in Swamp of Sorrows/Blasted Lands
		NOT = {
			any_owned_province = {
				OR = {
					region = region_blasted_lands
					region = region_swamp_of_sorrows
				}
			}
		}
	}
	
    mean_time_to_happen = {
		months = 12
    }
    
	option = {
		name = first_war.1.option.a
		
        # Give ROOT land in Swamp of Sorrows/Blasted Lands
        random_province = {
            limit = {
				OR = {
					region = region_blasted_lands
					region = region_swamp_of_sorrows
				}
                is_empty = yes
            }

            cede_province = ROOT
            add_core = ROOT
            change_culture = ROOT
            change_religion = ROOT
        }
		region_elwynn_forest = {
			add_permanent_claim = ROOT
		}
		region_deadwind_pass = {
			add_permanent_claim = ROOT
		}
    }
}

# Instruments of Gul'dan
country_event = {
	id = first_war.2
	title = first_war.2.title
	desc = first_war.2.desc
	picture = ORCISH_INVASION_eventPicture
    
	trigger = {
        NOT = { has_global_flag = setup_twilight_hammer }
        NOT = { exists = A43 }
        
        has_country_modifier = head_of_old_horde
        current_age = age_orcish_horde
        
        # Any land is empty in Swamp of Sorrows/Blasted Lands
		any_province = {
			OR = {
				region = region_blasted_lands
				region = region_swamp_of_sorrows
			}
			is_empty = yes
		}
	}
	
    immediate = {
        hidden_effect = {
            set_global_flag = setup_twilight_hammer
        }
    }
    
    mean_time_to_happen = {
		months = 1
    }
    
	option = {
		name = first_war.2.option.a
		
        random_province = {
            limit = {
				OR = {
					region = region_blasted_lands
					region = region_swamp_of_sorrows
				}
                is_empty = yes
            }

            cede_province = A43
            add_core = A43
            change_culture = culture_twilight_cultist
            change_religion = fel
        }
        
        A43 = {
            add_country_modifier = {
                name = member_of_old_horde
                duration = -1
            }
        }
    }
}

# Assault on Stormwind
country_event = {
	id = first_war.4
	title = first_war.4.title
	desc = first_war.4.desc
	picture = ORCISH_INVASION_eventPicture

    hidden = yes
    
	trigger = {
        NOT = { has_global_flag = stormwind_attack }
        current_age = age_orcish_horde
        
        # When a human that has a province in the Stormwind area sieged down by an orc clan
        any_country = {
            has_country_modifier = first_war_human
            
            any_owned_province = {
                area = area_stormwind # Grab the owner of a capital in Stormwind, normally STW
                
                controller = {
                    has_country_modifier = first_war_orc
                }
            }
        }
	}
	
    mean_time_to_happen = {
		months = 1
    }
    
    immediate = {
        hidden_effect = {
            set_global_flag = stormwind_attack
        }
    }
    
	option = {
		name = first_war.4.option.a
		
        custom_tooltip = AZEROTHIAN_ALLIANCE_RALLIES
        
        hidden_effect = {
            every_country = {
                limit = {
                    has_country_modifier = first_war_human
                }
                
                if = {
                    limit = {
                        has_country_modifier = fall_of_capital
                    }
                    remove_country_modifier = fall_of_capital 
                }
                
                add_country_modifier = {
                    name = assault_on_stormwind
                    duration = 1825
                }
            }
        }
    }
}

# Victory of Orc Clans
country_event = {
	id = first_war.5
	title = first_war.5.title
	desc = first_war.5.desc
	picture = ORCISH_INVASION_eventPicture

    major = yes
    
	trigger = {
        NOT = { has_global_flag = tfw_victory_of_the_orc_clans }
        current_age = age_orcish_horde
        
        area_stormwind = {
			controller = {
				culture_group = culture_group_orc
			}
        }
	}
	
    mean_time_to_happen = {
		days = 1
    }
    
    immediate = {
        hidden_effect = {
            set_global_flag = tfw_victory_of_the_orc_clans 
            set_global_flag = tfw_orc_victory_path
            set_global_flag = the_second_war
        }
    }
    
    option = {
		name = first_war.5.option.a
		
        every_country = {
            limit = {
                has_country_modifier = first_war_orc
                NOT = {
                    has_country_modifier = tfw_orc_victory
                }
                NOT = { has_global_flag = first_war_over }
            }
            add_country_modifier = {
                name = tfw_orc_victory
                duration = 3650
            }
            set_global_flag = first_war_over
        }
    }
}

# Orcish Horde Quelled!
country_event = {
	id = first_war.6
	title = first_war.6.title
	desc = first_war.6.desc
	picture = ORCISH_INVASION_eventPicture

    major = yes
    
    trigger = {
		NOT = { has_global_flag = tfw_human_victory_path }
        current_age = age_orcish_horde
        
        1035 = {
			controller = {
				OR = {
					culture_group = culture_group_human
					religion = holy_light
                }
			}
        }
	}
    
    immediate = {
        hidden_effect = {
            set_global_flag = tfw_human_victory_path
        }
    }
    
	option = {
		name = first_war.6.option.a
		
        add_country_modifier = {
            name = tfw_human_victory
            duration = 3650
        }
    }
}