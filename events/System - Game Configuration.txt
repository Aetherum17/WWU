namespace = wwu_game_configuration

# Game Configuration
country_event = {
	id = wwu_game_configuration.1
	title = wwu_game_configuration.1.title
	desc = wwu_game_configuration.1.desc
	picture = BESTIARY_eventPicture
    
	is_triggered_only = yes

    # Feature Configuration
    option = {
		name = wwu_game_configuration.1.option.features
		
        country_event = { id = wwu_game_configuration.2 }
	}
    
    # Difficulty Configuration
    option = {
		name = wwu_game_configuration.1.option.difficulty
		
        country_event = { id = wwu_game_configuration.3 }
	}
    
    # Finalize Configuration
    option = {
		name = wwu_game_configuration.1.option.finalize
		
        custom_tooltip = FINALIZE_CONFIG_TT
        
        hidden_effect = {
            set_global_flag = set_game_config
        }
	}
    
    # Exit
    option = {
		name = wwu_game_configuration.1.option.exit
		
	}
}

# Feature Configuration
country_event = {
	id = wwu_game_configuration.2
	title = wwu_game_configuration.2.title
	desc = wwu_game_configuration.2.desc
	picture = MAGIC_TOME_eventPicture
    
	is_triggered_only = yes

    # Racial Modifiers
    option = {
		name = wwu_game_configuration.2.option.racial_modifiers.on
		
        trigger = {
            NOT = { has_global_flag = enabled_racial_modifiers }
        }
        
        custom_tooltip = RACIAL_MODIFIERS_ON_TT
        
        hidden_effect = {
            set_global_flag = enabled_racial_modifiers
            country_event = { id = wwu_game_configuration.20 }
        }
	}
    option = {
		name = wwu_game_configuration.2.option.racial_modifiers.off
		
        trigger = {
            has_global_flag = enabled_racial_modifiers
        }
        
        custom_tooltip = RACIAL_MODIFIERS_OFF_TT
        
        hidden_effect = {
            clr_global_flag = enabled_racial_modifiers
            country_event = { id = wwu_game_configuration.20 }
        }
	}
    
    # Magic
    option = {
		name = wwu_game_configuration.2.option.magic.on
		
        trigger = {
            NOT = { has_global_flag = enabled_magic_mechanics }
        }
        
        custom_tooltip = MAGIC_ON_TT
        
        hidden_effect = {
            set_global_flag = enabled_magic_mechanics
            country_event = { id = wwu_game_configuration.20 }
        }
	}
    option = {
		name = wwu_game_configuration.2.option.magic.off
		
        trigger = {
            has_global_flag = enabled_magic_mechanics
        }
        
        custom_tooltip = MAGIC_OFF_TT
        
        hidden_effect = {
            clr_global_flag = enabled_magic_mechanics
            country_event = { id = wwu_game_configuration.20 }
        }
	}
    
    # Archaeology
    option = {
		name = wwu_game_configuration.2.option.archaeology.on
		
        trigger = {
            NOT = { has_global_flag = enabled_archaeology_mechanics }
        }
        
        custom_tooltip = ARCHAEOLOGY_ON_TT
        
        hidden_effect = {
            set_global_flag = enabled_archaeology_mechanics
            country_event = { id = wwu_game_configuration.20 }
        }
	}
    option = {
		name = wwu_game_configuration.2.option.archaeology.off
		
        trigger = {
            has_global_flag = enabled_archaeology_mechanics
        }
        
        custom_tooltip = ARCHAEOLOGY_OFF_TT
        
        hidden_effect = {
            clr_global_flag = enabled_archaeology_mechanics
            country_event = { id = wwu_game_configuration.20 }
        }
	}
    
    # Isolation
    option = {
		name = wwu_game_configuration.2.option.isolation.on
		
        trigger = {
            NOT = { has_global_flag = enabled_isolation_mechanics }
        }
        
        custom_tooltip = ISOLATION_ON_TT
        
        hidden_effect = {
            set_global_flag = enabled_isolation_mechanics
            country_event = { id = wwu_game_configuration.20 }
        }
	}
    option = {
		name = wwu_game_configuration.2.option.isolation.off
		
        trigger = {
            has_global_flag = enabled_isolation_mechanics
        }
        
        custom_tooltip = ISOLATION_OFF_TT
        
        hidden_effect = {
            clr_global_flag = enabled_isolation_mechanics
            country_event = { id = wwu_game_configuration.20 }
        }
	}
    
    # Federations
    option = {
		name = wwu_game_configuration.2.option.federations.on
		
        trigger = {
            NOT = { has_global_flag = enabled_federations }
        }
        
        custom_tooltip = FEDERATIONS_ON_TT
        
        hidden_effect = {
            set_global_flag = enabled_federations
            country_event = { id = wwu_game_configuration.20 }
        }
	}
    option = {
		name = wwu_game_configuration.2.option.federations.off
		
        trigger = {
            has_global_flag = enabled_federations
        }
        
        custom_tooltip = FEDERATIONS_OFF_TT
        
        hidden_effect = {
            clr_global_flag = enabled_federations
            country_event = { id = wwu_game_configuration.20 }
        }
	}
    
    # Alliance Restrictions
    option = {
		name = wwu_game_configuration.2.option.alliance_restrictions.on
		
        trigger = {
            NOT = { has_global_flag = enabled_lore_diplomacy_mechanics }
        }
        
        custom_tooltip = ALLIANCE_RESTRICTIONS_ON_TT
        
        hidden_effect = {
            set_global_flag = enabled_lore_diplomacy_mechanics
            country_event = { id = wwu_game_configuration.20 }
        }
	}
    option = {
		name = wwu_game_configuration.2.option.alliance_restrictions.off
		
        trigger = {
            has_global_flag = enabled_lore_diplomacy_mechanics
        }
        
        custom_tooltip = ALLIANCE_RESTRICTIONS_OFF_TT
        
        hidden_effect = {
            clr_global_flag = enabled_lore_diplomacy_mechanics
            country_event = { id = wwu_game_configuration.20 }
        }
	}
    
    # Factions
    option = {
		name = wwu_game_configuration.2.option.factions.on
		
        trigger = {
            NOT = { has_global_flag = enabled_faction_mechanics }
        }
        
        custom_tooltip = FACTIONS_ON_TT
        
        hidden_effect = {
            set_global_flag = enabled_faction_mechanics
            country_event = { id = wwu_game_configuration.20 }
        }
	}
    option = {
		name = wwu_game_configuration.2.option.factions.off
		
        trigger = {
            has_global_flag = enabled_faction_mechanics
        }
        
        custom_tooltip = FACTIONS_OFF_TT
        
        hidden_effect = {
            clr_global_flag = enabled_faction_mechanics
            country_event = { id = wwu_game_configuration.20 }
        }
	}
    
    # Exit
    option = {
		name = wwu_game_configuration.2.option.exit
		
        country_event = { id = wwu_game_configuration.1 }
	}
}

# Difficulty Configuration
country_event = {
	id = wwu_game_configuration.3
	title = wwu_game_configuration.3.title
	desc = wwu_game_configuration.3.desc
	picture = MAGIC_TOME_eventPicture
    
	is_triggered_only = yes

    # Vanquisher System
    option = {
		name = wwu_game_configuration.3.option.vanquisher.on
		
        trigger = {
            NOT = { has_global_flag = enabled_vanquisher_system }
        }
        
        custom_tooltip = VANQUISHER_ON_TT
        
        hidden_effect = {
            set_global_flag = enabled_vanquisher_system
            country_event = { id = wwu_game_configuration.21 }
        }
	}
    option = {
		name = wwu_game_configuration.3.option.vanquisher.off
		
        trigger = {
            has_global_flag = enabled_vanquisher_system
        }
        
        custom_tooltip = VANQUISHER_OFF_TT
        
        hidden_effect = {
            clr_global_flag = enabled_vanquisher_system
            country_event = { id = wwu_game_configuration.21 }
        }
	}
    
    # Exit
    option = {
		name = wwu_game_configuration.3.option.exit
		
        country_event = { id = wwu_game_configuration.1 }
	}
}

# Loop event - Features
country_event = {
	id = wwu_game_configuration.20
	title = wwu_game_configuration.20.title
	desc = wwu_game_configuration.20.desc
	picture = MAGIC_TOME_eventPicture
    
    hidden = yes
	is_triggered_only = yes

    option = {
		name = wwu_game_configuration.20.option.a
		
        country_event = { id = wwu_game_configuration.2 }
	}
}

# Loop event - Difficulty
country_event = {
	id = wwu_game_configuration.21
	title = wwu_game_configuration.21.title
	desc = wwu_game_configuration.21.desc
	picture = MAGIC_TOME_eventPicture
    
    hidden = yes
	is_triggered_only = yes

    option = {
		name = wwu_game_configuration.21.option.a
		
        country_event = { id = wwu_game_configuration.3 }
	}
}


# Defaults
country_event = {
	id = wwu_game_configuration.100
	title = wwu_game_configuration.100.title
	desc = wwu_game_configuration.100.desc
	picture = MAGIC_TOME_eventPicture
    
    hidden = yes
	is_triggered_only = yes
    
    trigger = {
        NOT = { has_global_flag = set_game_config }
    }

    option = {
		name = wwu_game_configuration.100.option.a
		
        # Enabled by Default
        set_global_flag = enabled_isolation_mechanics
        set_global_flag = enabled_federations
        set_global_flag = enabled_racial_modifiers
        set_global_flag = enabled_magic_mechanics
        set_global_flag = enabled_archaeology_mechanics
        set_global_flag = enabled_faction_mechanics
        
        # Disabled by Default
        #set_global_flag = enabled_lore_diplomacy_mechanics
        #set_global_flag = enabled_vanquisher_system
	}
}

# Vanquisher System
country_event = {
	id = wwu_game_configuration.200
	title = wwu_game_configuration.200.title
	desc = wwu_game_configuration.200.desc
	picture = MAGIC_TOME_eventPicture
    
    hidden = yes
    is_triggered_only = yes
    
    trigger = {
		has_dlc = "Rights of Man"
        has_global_flag = enabled_vanquisher_system
        

        # Wait 10 years after start before assigning any Vanquishers
        had_global_flag = {
            flag = game_duration_timer
            days = 3650
        }
                
		ai = yes
		is_subject = no
        NOT = { ruler_has_personality = vanquisher_personality }
        
        # Only 5 at one time
        NOT = {
            calc_true_if = {
                amount = 5
                
                all_country = {
                    ruler_has_personality = vanquisher_personality
                }
            }
        }
        
        # Must be of a suitable size
        num_of_cities = 3
        
        # Must not be bankrupt
        NOT = { is_bankrupt = yes }
        
        # Must not be next to the player within the first 50 years
        if = {
            limit = {
                had_global_flag = {
                    flag = game_duration_timer
                    days = 18250
                }
            }
            
            any_neighbor_country = { 
                ai = no 
            }
        }
	}
    
    option = {
		name = wwu_game_configuration.200.option.a
		
        add_ruler_personality = vanquisher_personality
        add_ruler_modifier = {
            name = vanquisher_bonus
            duration = -1
        }
        
        set_ai_personality = {
            personality = ai_militarist
            locked = yes
        }
        
        add_stability = 3
        add_prestige = 100
        
        change_adm = 2
        change_dip = 2
        change_mil = 4
	}
}
