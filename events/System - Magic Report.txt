namespace = wwu_magic_report

# Magic Report
country_event = {
	id = wwu_magic_report.1
	title = wwu_magic_report.1.title
	desc = wwu_magic_report.1.desc
	picture = MAGIC_TOME_eventPicture
	
	is_triggered_only = yes
    
    # Select Magic Specialization
    option = {
		name = wwu_magic_report.1.option.ruler_magic_specialization
        
        trigger = {
            has_global_flag = enabled_magic_mechanics
			has_country_flag = allow_magic_specialization_decision
        }
        
        hidden_effect = {
            set_country_flag = skip_status_report_return
            set_country_flag = status_report_origin
        }
        
        # hidden_effect = {
            # clr_country_flag = allow_magic_specialization_decision
        # }
        country_event = { id = wwu_magic.80 }
        
        ai_chance = {
            factor = 0
        }
	}
    
    # Improve Magical Skill
    option = {
		name = wwu_magic_report.1.option.magical_skill_training
        
        trigger = {
            NOT = { has_country_modifier = ruler_investment_cooldown }
            has_global_flag = enabled_magic_mechanics
            has_ruler_modifier = spellcaster_capabilities
            NOT = { has_ruler_modifier = recently_trained_magic }
        }
        
        hidden_effect = {
            set_country_flag = skip_status_report_return
        }
        
        country_event = { id = wwu_magic.60 }
        
        custom_tooltip = RULER_INVESTMENT_DURATION_TT
        hidden_effect = {
            add_country_modifier = {
                name = ruler_investment_cooldown
                duration = 1800
                hidden = yes
            }
        }
        
        ai_chance = {
            factor = 1
            
            modifier = {
                factor = 0
                
                NOT = { adm_power = 300 }
                NOT = { dip_power = 300 }
                NOT = { mil_power = 300 }
            }
        }
	}
    
    
    option = {
		name = wwu_magic_report.1.option.exit
        
        ai_chance = {
            factor = 1
        }
	}
    
    after = {
        if = {
            limit = {
                has_country_flag = skip_status_report_return
            }
            
            clr_country_flag = skip_status_report_return
        }
        else = {
            country_event = { id = wwu_compendium.1 }
        }
    }
}

