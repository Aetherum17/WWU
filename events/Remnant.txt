namespace = remnant

country_event = {
	id = remnant.1
	title = remnant_creation.title
	desc = remnant_creation.desc
	picture = BRAWL_eventPicture
	#goto = root
	
	is_triggered_only = yes
	hidden = yes
	
	trigger = {
		NOT = { has_reform = remnant_basic_reform }
		NOT = { is_subject = yes }
		prestige = -10
	}
	
	immediate = {
		random_country = {
			limit = { potential_refuge = yes }
			country_event = { id = remnant.3 }
		}
	}
	
	option = {
		name = remnant_creation.opt1
		log = "remnant_creation.opt1"
	}
}
country_event = {
	id = remnant.3
	title = remnant_creation.title
	desc = remnant_creation.desc
	picture = BRAWL_eventPicture
	#goto = root
	
	is_triggered_only = yes
	major = yes
	
	trigger = {
	}
	
	immediate = {
		#log = "[From.GetName] asked [Root.GetName] to vassalize them after they escaped from destruction." #COMMENT IN AT WORKSHOP VERSION
	}
	
	option = {
		name = remnant_creation.opt1
		log = "remnant_creation.opt1"
		ai_chance = { factor = 1 }
		
		hidden_effect = {
			set_variable = {
				which = provinces
				value = 0
			}
			set_variable = {
				which = counter
				value = 0
			}
			set_variable = {
				which = absolute_max
				value = 7
			}
			every_owned_province = {
				ROOT = {
					change_variable = {
						which = provinces
						value = 1
					}
				}
			}
			divide_variable = {
				which = provinces
				value = 10
			}
			random_owned_province = {
				limit = { is_capital = no }
				change_culture = FROM
				cede_to_culture = yes
				owner = {
					ROOT = {
						vassalize = PREV
					}
				}
			}
			while = {
				limit = {
					check_variable = {
						which = provinces
						which = counter
					}
					check_variable = {
						which = absolute_max
						which = counter
					}
				}
				random_owned_province = {
					limit = { 
						is_capital = no
						any_neighbor_province = {
							owned_by = FROM
						}
					}
					change_culture = FROM
					cede_to_culture = yes
				}
				change_variable = {
					which = counter
					value = 1
				}
			}
		}
		add_prestige = 20
		every_ally = {
			add_trust = {
				who = ROOT
				value = 20
				mutual = yes
			}
		}
		custom_tooltip = remnant_creation.opt1.tt
	}
	option = {
		name = remnant_creation.opt2
		log = "remnant_creation.opt2"
		
		ai_chance = { factor = 1 }
	}
}
country_event = {
	id = remnant.2
	title = remnant_integration.title
	desc = remnant_integration.desc
	picture = BRAWL_eventPicture
	#goto = root
	
	mean_time_to_happen = {
		months = 6
	}
	
	trigger = {
		has_country_flag = being_inherited
		any_neighbor_country = {
			has_country_flag = inheriting
		}
	}
	
	immediate = {
		random_neighbor_country = {
			limit = {
				has_country_flag = inheriting
			}
			save_event_target_as = inheritor
		}
	}
	
	option = {
		name = remnant_integration.opt1
		log = "remnant_integration.opt1"
		random_owned_province = {
			limit = {
				any_neighbor_province = {
					owned_by = event_target:inheritor
				}
			}
			cede_province = event_target:inheritor
		}
	}
}